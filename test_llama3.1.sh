#!/bin/bash
# Disk Space Monitor - Generated by llama3.1
# Alerts when disk usage exceeds 90%

THRESHOLD=90
CURRENT_USAGE=$(df / | grep -vE '^Filesystem|tmpfs|cdrom' | awk '{print $5}' | sed 's/%//g')

if [ "$CURRENT_USAGE" -ge "$THRESHOLD" ]; then
    echo "WARNING: Disk usage is at ${CURRENT_USAGE}%"
    # Send alert via Telegram or email
    if command -v curl &> /dev/null; then
        curl -s -X POST "https://api.telegram.org/bot${TELEGRAM_BOT_TOKEN}/sendMessage" \
            -d "chat_id=${TELEGRAM_CHAT_ID}" \
            -d "text=ðŸš¨ DISK ALERT: Usage at ${CURRENT_USAGE}% on $(hostname)"
    fi
    exit 1
else
    echo "OK: Disk usage is at ${CURRENT_USAGE}%"
    exit 0
fi