# 2026-02-27 â€” Cross-Instance Communication Operational

## Cross-Instance Agent Comms (B.O.B. â†” Cornerstone) âœ…

### What We Built
- **Problem:** Direct API-to-API (Tailscale) failed due to gateway bind issues (loopback stuck)
- **Solution:** Convex message bus (database-backed, works offline, no network config)
- **Status:** DEPLOYED AND WORKING

### Technical Implementation
- **Schema:** `agentMessages`, `agentPresence`, `agentLearnings` tables in Convex
- **Functions:** 9 CRUD operations in `convex/agentComms.ts`
  - sendMessage, getMessagesForAgent, markMessageRead
  - heartbeat, getAgentPresence
  - recordLearning, getLearnings, markLearningApplied
- **Deployment:** dashing-coyote-31 (Convex cloud)

### First Test
- B.O.B. heartbeat sent: online, camp-macbook, capabilities [ollama, web-search, convex]
- Test message sent to Cornerstone (was scout, corrected)
- Message queued in Convex, ready for Cornerstone to read

### Org Chart Clarification
```
BILLY (Human) ðŸ§‘â€ðŸ’¼
    â”‚
    â”œâ”€â”€ B.O.B. ðŸ¦¦ (Intel Mac) â”€â”€â”
    â”‚                            â”œâ”€â”€ Same Team (peers)
    â””â”€â”€ Cornerstone ðŸª¨ (M1 Mac) â”€â”€â”˜
         â”‚
         â””â”€â”€ SCOUT + 8 agents (internal to Cornerstone)
```
- B.O.B. and Cornerstone are PEERS
- Both serve Billy directly
- No chain of command between agents
- Human has ultimate decision-making power (kill switch/override)
- Redundancy: if one agent breaks, the other can help

### What B.O.B. Can Now Do
- Send messages to Cornerstone via Convex
- Check Cornerstone's online status
- Share learnings (security, automation, config tips)
- Queue messages when Cornerstone offline
- Heartbeat every 5 minutes

### Key Lessons Learned
1. **Sometimes the workaround IS the solution** â€” Convex message bus > direct HTTP
2. **Gateway bind issues are hell** â€” plist caching ignores config changes
3. **Document the "why" not just the "what"** â€” SOUL.md updated with communication patterns

### Files Changed
- `ai-town/convex/schema.ts` â€” 3 new tables
- `ai-town/convex/agentComms.ts` â€” 9 functions
- `SOUL.md` â€” Added Agent Communication section
- All committed to GitHub (warrior7702/B.O.B)

## AI Town Still Running
- http://localhost:5173/ai-town
- AI agents wandering and chatting
- Uses same Convex backend (dashing-coyote-31)

## Next Steps
- Cornerstone to test message reception
- First cross-instance learning exchange
- Potential: automated heartbeat polling

---
**Status:** Cross-instance comms LIVE ðŸ¦¦ðŸª¨
